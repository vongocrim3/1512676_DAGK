(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{161:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(81),i=a(5),u=a(6),c=a(8),o=a(7),l=a(9),d=a(18),p="SIGNIN",h="SIGNIN_SUCCESS",m="SIGNIN_ERROR",b=a(2),f=a.n(b);function E(){return function(e){e({type:p});var t=new f.a.auth.GoogleAuthProvider;f.a.auth().signInWithPopup(t).then(function(t){var a=t.user,n=a.uid,r=a.displayName,s=a.photoURL,i=a.email;f.a.database().ref("users/".concat(n)).set({displayName:r,photoURL:s,email:i,lastTimeLoggedIn:f.a.database.ServerValue.TIMESTAMP}),e(function(e){return{type:h,uid:e}}(n))}).catch(function(t){var a;e((a=t.message,{type:m,errorMessage:a}))})}}var g,S=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.onSignInClick;return r.a.createElement("button",{onClick:e},"Signin Here")}}]),t}(n.Component),O=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onSignInClick,a=e.auth;return r.a.createElement("div",null,a.isUserSignedIn?r.a.createElement("p",null,"Welcome ",a.displayName):r.a.createElement(S,{onSignInClick:t,auth:a}))}}]),t}(n.Component),v=Object(d.b)(function(e){return{auth:e.auth}},function(e){return{onSignInClick:function(){e(E())}}})(O),y=a(4),j=function(e){return function(t,a){var n,r=a().auth.uid,s=a().users[r].displayName;0!==r?(t((n={uid:r,displayName:s,message:e},Object(y.a)({type:"SEND_MESSAGE"},n))),f.a.database().ref("messages").push({uid:r,displayName:s,message:e,createdAt:f.a.database.ServerValue.TIMESTAMP})):t({type:"SEND_MESSAGE_ERROR"})}},I=function(e){var t=e.dispatch;return r.a.createElement("input",{type:"text",ref:function(e){return g=e},onKeyUp:function(e){13===e.keyCode&&(t(j(g.value)),g.value="")}})},N=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this._firebaseRef=f.a.database().ref("messages"),this._firebaseRef.on("child_added",function(t){var a,n=t.val(),r=n.uid,s=n.displayName,i=n.message;e.props.dispatch({type:"RETRIEVE_MESSAGE",uid:(a={uid:r,displayName:s,message:i}).uid,displayName:a.displayName,message:a.message})})}},{key:"render",value:function(){var e=this.props.messages;return r.a.createElement("ul",null,e.map(function(e){return r.a.createElement("li",null,e.displayName+": "+e.message)}))}},{key:"componentWillUnmount",value:function(){this._firebaseRef.off()}}]),t}(n.Component),M=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.dispatch,a=e.userMessage,n=e.isUserSignedIn,s=e.messages;return r.a.createElement("div",null,r.a.createElement(N,{dispatch:t,messages:s}),n&&r.a.createElement(I,{userMessage:a,dispatch:t}))}}]),t}(n.Component),R=Object(d.b)(function(e){return{userMessage:e.userMessage,isUserSignedIn:e.auth.isUserSignedIn,messages:e.messages}})(M),_=a(28),A=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;f.a.database().ref("users").on("child_added",function(t){var a;e.props.dispatch({type:"USER_LOGGED_IN",uid:(a={uid:t.key,userPayload:t.val()}).uid,userPayload:a.userPayload})})}},{key:"showUsersList",value:function(e){return e?Object.keys(e).reduce(function(t,a){return Object(_.a)(t).concat([Object(y.a)({uid:a},e[a])])},[]):[]}},{key:"render",value:function(){var e=this.props.users;return r.a.createElement("ul",null,this.showUsersList(e).map(function(e){return r.a.createElement("li",null,e.displayName)}))}}]),t}(n.Component),C=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.dispatch,a=e.users;return r.a.createElement(A,{dispatch:t,users:a})}}]),t}(n.Component),k=Object(d.b)(function(e){return{users:e.users}})(C),G=a(37),w=(a(159),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).state={isSignedIn:!1},a.uiConfig={signInFlow:"popup",signInOptions:[f.a.auth.GoogleAuthProvider.PROVIDER_ID],callbacks:{signInSuccess:function(){return!1}}},a.componentDidMount=function(){f.a.auth().onAuthStateChanged(function(e){a.setState({isSignedIn:!!e}),console.log("user",e)})},a}return Object(l.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"React Redux Firebase Chat App"),r.a.createElement(v,null),r.a.createElement(G.b,null,r.a.createElement(G.a,{size:"8/12"},r.a.createElement(R,null)),r.a.createElement(G.a,null,r.a.createElement(k,null))))}}]),t}(n.Component)),U=a(22),D={isUserSignedIn:!1,isInProgress:!1,hasError:!1,errorMessage:"",uid:0};var P={isSending:!1,isTyping:!1,items:[]},L=a(35),T=Object(U.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:var a=t.uid;return Object(y.a)({},e,{isUserSignedIn:!0,isInProgress:!1,uid:a});case p:return Object(y.a)({},e,{isInProgress:!0});case m:var n=t.errorMessage;return Object(y.a)({},e,{hasError:!0,errorMessage:n});default:return e}},userMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEND_MESSAGE":return Object(y.a)({},e,{isSending:!0,items:function(e,t){switch(t.type){case"SEND_MESSAGE":var a=t.uid,n=t.displayName,r=t.message,s=t.createdAt;return Object(_.a)(e).concat([{uid:a,displayName:n,message:r,createdAt:s}]);case"SEND_MESSAGE_SUCCESS":case"SEND_MESSAGE_ERROR":default:return e}}(e.items,t)});case"SEND_MESSAGE_SUCCESS":return Object(y.a)({},e,{isSending:!1,hasError:!1});case"SEND_MESSAGE_ERROR":return Object(y.a)({},e,{hasError:!0,errorMessage:t.errorMessage});default:return e}},messages:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RETRIEVE_MESSAGE":var a=t.uid,n=t.displayName,r=t.message;return Object(_.a)(e).concat([{uid:a,displayName:n,message:r}]);default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOGGED_IN":var a=t.uid,n=t.userPayload;return Object(y.a)({},e,Object(L.a)({},a,Object(y.a)({},n)));default:return e}}}),V=a(59),x=a(84),z=a.n(x),F={apiKey:"AIzaSyClDuO_AtFxw4Uu52o2dJGbYPgX-pMXMeA",authDomain:"reactjs-firebase-88e5e.firebaseapp.com",databaseURL:"https://reactjs-firebase-88e5e.firebaseio.com",projectId:"reactjs-firebase-88e5e"};f.a.initializeApp(F);f.a.database(),new f.a.auth.GoogleAuthProvider;window.firebase&&f.a.initializeApp(F);z()();var J=[V.a],W=Object(U.d)(T,U.a.apply(void 0,J));Object(s.render)(r.a.createElement(d.a,{store:W},r.a.createElement(w,null)),document.querySelector("#react-container"))},85:function(e,t,a){e.exports=a(161)}},[[85,2,1]]]);
//# sourceMappingURL=main.04f3a57a.chunk.js.map